/* tag : v1.0.1 */
!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var o in i)("object"==typeof exports?exports:t)[o]=i[o]}}(window,(function(){return function(t){var e={};function i(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(o,r,function(e){return t[e]}.bind(null,r));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/",i(i.s=11)}({0:function(t,e){t.exports=require("jquery")},1:function(t,e,i){"use strict";i.r(e),i.d(e,"default",(function(){return v}));var o=i(0),r=i.n(o);const a="loadstart",n="loaded",s="ended",u="currentTimeUpdate",l="mute",h="unmute",d="volumeUpdate",c="pause",f="play",p="watcherUpdate",m="destroy";class v{constructor(t){this.config={src:"",autoPlay:!1,frequency:200,volume:.5},this.$eventEl=r()("<div />"),this.watcher=0,this.audio=new Audio,this.canplay=!1,this.firstTimeLoad=!0,this.config=Object.assign(this.config,t),this.lastVolume=this.config.volume,this.init()}init(){this.audio=new Audio,this.event_handler(),this.load_audio(this.config.src,this.config.autoPlay)}play(){this.canplay&&this.audio.paused&&this.hack_chrome_autoplay_policy()}pause(t=!1){(this.canplay&&!this.audio.paused||t)&&(this.$eventEl.trigger(c,[this.audio.currentTime,this.audio.duration,this.audio]),window.clearInterval(this.watcher),this.audio.pause())}toggle_play(){this.audio.paused?this.play():this.pause()}mute(){this.canplay&&0!==this.audio.volume&&(this.lastVolume=this.audio.volume,this.audio.volume=0,this.$eventEl.trigger(l))}unmute(){this.canplay&&(this.audio.volume=this.lastVolume,this.$eventEl.trigger(h,this.lastVolume))}toggle_mute(){0===this.audio.volume?this.unmute():this.mute()}load_audio(t,e){this.canplay=!1,r()(this.audio).one("canplay",()=>{this.canplay=!0,this.$eventEl.trigger(n,[this.audio.currentTime,this.audio.duration]),e&&this.hack_chrome_autoplay_policy()}),this.audio.src=t,this.audio.load()}set_volume(t){this.canplay&&(this.audio.volume=t,this.$eventEl.trigger(d,[t]))}get_volume(){if(this.canplay)return this.audio.volume}set_current_time(t,e=!1){this.canplay&&(this.audio.currentTime=e?Math.floor(this.audio.duration*t):t,this.$eventEl.trigger(u,[this.audio.currentTime,this.calc_percentage(this.audio.currentTime,this.audio.duration),this.audio]))}get_current_time(){if(this.canplay)return this.audio.currentTime}get_duration(){return this.audio.duration}format_time(t){let e=String("00"+Math.floor(t/3600)).slice(-2)+":",i=String("00"+Math.floor(t%3600/60)).slice(-2)+":",o=String("00"+Math.floor(t%3600%60)).slice(-2);return t>3600?e+i+o:i+o}destroy(){this.$eventEl.trigger(m),window.clearInterval(this.watcher),this.canplay=!1,this.$eventEl.remove(),this.audio.src=""}on(t,e){return this.$eventEl.on(t,e),this}one(t,e){return this.$eventEl.one(t,e),this}off(t){return this.$eventEl.off(t),this}event_handler(){r()(this.audio).on("loadstart",()=>{this.$eventEl.trigger(a)}).on("ended",()=>{this.$eventEl.trigger(s)})}set_watcher_interval(){window.clearInterval(this.watcher),this.watcher=window.setInterval(()=>{this.$eventEl.trigger(p,[this.audio.currentTime,this.calc_percentage(this.audio.currentTime,this.audio.duration),this.audio.duration,this.audio.ended])},this.config.frequency)}set_default_volume(){this.firstTimeLoad&&(this.set_volume(this.config.volume),this.firstTimeLoad=!1)}calc_percentage(t,e){return+(Math.trunc(t)/Math.trunc(e)).toFixed(4)}hack_chrome_autoplay_policy(){let t=this.audio.play();void 0!==t?t.then(()=>{this.set_default_volume(),this.$eventEl.trigger(f,[this.audio]),this.set_watcher_interval()}).catch(t=>{this.pause(!0),console.log(t,"vAudio必须要有用户交互才能自动播放, https://developers.google.com/web/updates/2016/03/play-returns-promise")}):(this.set_default_volume(),this.$eventEl.trigger(f,[this.audio]),this.set_watcher_interval())}}},11:function(t,e,i){t.exports=i(1)}})}));